# 網絡配置

核心小組可由以下人員組成

- 多個子網（推薦）
- 單一子網

## 具有多個子網的核心單元<a id="a-core-cell-with-multiple-subnets"></a>

建議在 DB + AppServer 和代理網絡服務器等一般網絡服務中使用雙層子網。 這種子網設計在安全性方面更具優勢。

由於還需要監控服務器作為另一層來管理所有服務器，因此下一節將介紹如何設置具有三層子網的 Core Cell。

三層子網由以下部分組成：

- CN 子網
- PN 子網
- 管理 (Mgmt) 子網

### CN 子網<a id="cn-subnet"></a>

CN 子網由核心小區內的 CN 服務器組成。 核心單元中的工作 CN 只有一個，但應準備備用 CN 以實現高可用性。 核心小區網絡 (CCN) 內所有 CN 的 IP/Port 必須相互開放，因為它們試圖從核心小區外部連接到其他 CN。 (該連接信息可從 Kairos 操作員處獲得）。 與核心單元中其他子網的內部通信需要打開默認端口（32323：Kaia P2P 默認端口號），以便與 PN 子網中的 PN 連接。 此外，還需要打開其他端口，如用於監控服務器的 CN 監控端口 (61001) 和用於管理的 SSH 端口 (22)。 如果使用多通道功能，則還應打開另一個端口（32324：默認多通道端口）。

![CN Subnet](/img/nodes/cn_subnet.png)

| 起源子網  | 目標子網    | Ingress                                   | Egress |
| :---- | :------ | :---------------------------------------- | :----- |
| CN 子網 | PN 子網   | P2P：32323（多通道為 32324）                     | 全部     |
| CN 子網 | 管理子網    | SSH: 22, Monitoring：61001 | 全部     |
| CN 子網 | 公眾（互聯網） | 每個 CN 的 IP 和 P2P 端口                       | 全部     |

### PN 子網<a id="pn-subnet"></a>

PN 子網由提供服務的 PN 服務器組成，以便與外部網絡連接。

PN 子網與以下節點相連：

- 核心細胞中的 CN
- 其他核心小組的一些 PN
- 核心單元管理服務器（管理、監控）
- EN 節點

![PN Subnet](/img/nodes/pn_subnet.png)

| 起源子網  | 目標子網    | Ingress                                   | Egress |
| :---- | :------ | :---------------------------------------- | :----- |
| PN 子網 | CN 子網   | P2P：32323（多通道為 32324）                     | 全部     |
| PN 子網 | 管理子網    | SSH: 22, Monitoring：61001 | 全部     |
| PN 子網 | 公眾（互聯網） | P2P: 32323                | 全部     |

### 管理子網<a id="mgmt-subnet"></a>

管理子網是操作員通過 ssh 進入核心單元節點的網關子網。 可能需要 VPN 服務器與監控服務器和安裝了管理 Core Cell 節點工具的管理服務器一起進行連接。

![Management Subnet](/img/nodes/admin_subnet.png)

| 起源子網 | 目標子網    | Ingress                                                                                               | Egress |
| :--- | :------ | :---------------------------------------------------------------------------------------------------- | :----- |
| 管理子網 | CN 子網   | 全部                                                                                                    | 全部     |
| 管理子網 | PN 子網   | 全部                                                                                                    | 全部     |
| 管理子網 | 公眾（互聯網） | VPN (tcp): 443, VPN (udp): 1194 | 全部     |

## 具有單一子網的核心單元<a id="a-core-cell-with-a-single-subnet"></a>

核心單元的單個子網用於開發/測試目的，或在困難情況下創建多個子網。

所有節點都設置在一個 CC 子網下。 還必須設置防火牆，CN 才能使用 P2P 端口（多通道選項為 32323、32324）連接 CNN 內的其他 CN。 PN 的 P2P 端口打開後，可與端點節點網絡 (ENN) 中的 EN 和核心小區網絡 (CNN) 中的 PN 連接。 此外，還需要可選的 VPN 和監控服務器，以便進行遠程管理。

![CC with a Single Subnet](/img/nodes/cc_single_subnet.png)
