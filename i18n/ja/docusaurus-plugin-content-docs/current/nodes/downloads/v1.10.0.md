# v1.10.0

## パッケージダウンロード

### 回転数<a id="rpm"></a>

サイプレス・パッケージ

- [kcnd-v1.10.0-0.el7.x86_64.rpm](https://packages.klaytn.net/klaytn/v1.10.0/kcnd-v1.10.0-0.el7.x86_64.rpm)
- [kpnd-v1.10.0-0.el7.x86_64.rpm](https://packages.klaytn.net/klaytn/v1.10.0/kpnd-v1.10.0-0.el7.x86_64.rpm)
- [kend-v1.10.0-0.el7.x86_64.rpm](https://packages.klaytn.net/klaytn/v1.10.0/kend-v1.10.0-0.el7.x86_64.rpm)

バオバブ・パッケージ

- [kcnd-baobab-v1.10.0-0.el7.x86_64.rpm](https://packages.klaytn.net/klaytn/v1.10.0/kcnd-baobab-v1.10.0-0.el7.x86_64.rpm)
- [kpnd-baobab-v1.10.0-0.el7.x86_64.rpm](https://packages.klaytn.net/klaytn/v1.10.0/kpnd-baobab-v1.10.0-0.el7.x86_64.rpm)
- [kend-baobab-v1.10.0-0.el7.x86_64.rpm](https://packages.klaytn.net/klaytn/v1.10.0/kend-baobab-v1.10.0-0.el7.x86_64.rpm)

共通パッケージ

- [kscnd-v1.10.0-0.el7.x86_64.rpm](https://packages.klaytn.net/klaytn/v1.10.0/kscnd-v1.10.0-0.el7.x86_64.rpm)
- [kspnd-v1.10.0-0.el7.x86_64.rpm](https://packages.klaytn.net/klaytn/v1.10.0/kspnd-v1.10.0-0.el7.x86_64.rpm)
- [ksend-v1.10.0-0.el7.x86_64.rpm](https://packages.klaytn.net/klaytn/v1.10.0/ksend-v1.10.0-0.el7.x86_64.rpm)
- [kbnd-v1.10.0-0.el7.x86_64.rpm](https://packages.klaytn.net/klaytn/v1.10.0/kbnd-v1.10.0-0.el7.x86_64.rpm)
- [kgen-v1.10.0-0.el7.x86_64.rpm](https://packages.klaytn.net/klaytn/v1.10.0/kgen-v1.10.0-0.el7.x86_64.rpm)
- [homi-v1.10.0-0.el7.x86_64.rpm](https://packages.klaytn.net/klaytn/v1.10.0/homi-v1.10.0-0.el7.x86_64.rpm)

### リナックス<a id="linux"></a>

サイプレス・パッケージ

- [kcn-v1.10.0-0-linux-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.10.0/kcn-v1.10.0-0-linux-amd64.tar.gz)
- [kpn-v1.10.0-0-linux-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.10.0/kpn-v1.10.0-0-linux-amd64.tar.gz)
- [ken-v1.10.0-0-linux-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.10.0/ken-v1.10.0-0-linux-amd64.tar.gz)

バオバブ・パッケージ

- [kcn-baobab-v1.10.0-0-linux-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.10.0/kcn-baobab-v1.10.0-0-linux-amd64.tar.gz)
- [kpn-baobab-v1.10.0-0-linux-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.10.0/kpn-baobab-v1.10.0-0-linux-amd64.tar.gz)
- [ken-baobab-v1.10.0-0-linux-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.10.0/ken-baobab-v1.10.0-0-linux-amd64.tar.gz)

共通パッケージ

- [kscn-v1.10.0-0-linux-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.10.0/kscn-v1.10.0-0-linux-amd64.tar.gz)
- [kspn-v1.10.0-0-linux-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.10.0/kspn-v1.10.0-0-linux-amd64.tar.gz)
- [ksen-v1.10.0-0-linux-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.10.0/ksen-v1.10.0-0-linux-amd64.tar.gz)
- [kbn-v1.10.0-0-linux-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.10.0/kbn-v1.10.0-0-linux-amd64.tar.gz)
- [kgen-v1.10.0-0-linux-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.10.0/kgen-v1.10.0-0-linux-amd64.tar.gz)
- [homi-v1.10.0-0-linux-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.10.0/homi-v1.10.0-0-linux-amd64.tar.gz)

### マックオス<a id="macos"></a>

サイプレス・パッケージ

- [kcn-v1.10.0-0-darwin-10.10-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.10.0/kcn-v1.10.0-0-darwin-10.10-amd64.tar.gz)
- [kpn-v1.10.0-0-darwin-10.10-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.10.0/kpn-v1.10.0-0-darwin-10.10-amd64.tar.gz)
- [ken-v1.10.0-0-darwin-10.10-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.10.0/ken-v1.10.0-0-darwin-10.10-amd64.tar.gz)

バオバブ・パッケージ

- [kcn-baobab-v1.10.0-0-darwin-10.10-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.10.0/kcn-baobab-v1.10.0-0-darwin-10.10-amd64.tar.gz)
- [kpn-baobab-v1.10.0-0-darwin-10.10-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.10.0/kpn-baobab-v1.10.0-0-darwin-10.10-amd64.tar.gz)
- [ken-baobab-v1.10.0-0-darwin-10.10-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.10.0/ken-baobab-v1.10.0-0-darwin-10.10-amd64.tar.gz)

共通パッケージ

- [kscn-v1.10.0-0-darwin-10.10-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.10.0/kscn-v1.10.0-0-darwin-10.10-amd64.tar.gz)
- [kspn-v1.10.0-0-darwin-10.10-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.10.0/kspn-v1.10.0-0-darwin-10.10-amd64.tar.gz)
- [ksen-v1.10.0-0-darwin-10.10-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.10.0/ksen-v1.10.0-0-darwin-10.10-amd64.tar.gz)
- [kbn-v1.10.0-0-darwin-10.10-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.10.0/kbn-v1.10.0-0-darwin-10.10-amd64.tar.gz)
- [kgen-v1.10.0-0-darwin-10.10-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.10.0/kgen-v1.10.0-0-darwin-10.10-amd64.tar.gz)
- [homi-v1.10.0-0-darwin-10.10-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.10.0/homi-v1.10.0-0-darwin-10.10-amd64.tar.gz)

### ウィンドウズ<a id="windows"></a>

- 未対応

## リリースノート

Klaytn v1.10.0はハードフォークアップグレードを含み、後方互換性のない変更をもたらします。 したがって、すべてのBaobab/Cypressノードは、ターゲットブロック番号の前にv1.10.0以上にアップグレードする必要がある。 ハードフォークの名前は「コレ」。 ハードフォークには、オンチェーンガバナンス投票法の実装([KIP81](https://kips.klaytn.foundation/KIPs/kip-81)、新しいGC報酬構造([KIP82](https://kips.klaytn.foundation/KIPs/kip-82)、EVMの変更が含まれる。

予定されているハードフォークのスケジュールは以下の通り：

- バオバブ111736800\` 1月10日 午前10時00分 (UTC+9)
- サイプレス2023年3月、次回のリリースで発表予定

## v1.10.0アップグレードとコレハードフォークに関する注意事項

Klaytnエコシステム参加者への重要な注意事項は以下の通り。 v1.10.0アップグレードとコレハードフォークを適用する前にお読みください。

- ブロックエクスプローラー（スコープ、ファインダー）およびガバナンス分析ツール用
  - Koreのハードフォーク後、統治投票はKIP-81に従ってスマートコントラクトで処理される。 既存のブロックヘッダ投票メカニズムは、契約ベースの投票メカニズムのフォールバックとしてのみ使用される。 確定したガバナンスデータは `governance_chainConfigAt(num)` または `klay_chainConfigAt(num)` API から取得できる。 投票データ分析のより詳細なドキュメントは、ガバナンス・コントラクト導入後に後日公開される。
  - コレハードフォークの後、ブロック報酬はKIP-82に従ってブロック提案者と同様にすべての有効なステーカー（CN）に分配される。 ジニ係数は提案者選定に無視されるため、提案者間の公平な報酬分配が可能となる。 新しい `klay_getRewards(num)` API を使って、燃焼量を含む報酬分配の詳細を取得することができます。

- ノードオペレータの場合
  - すべてのノードは、コレハードフォークのブロック番号の前にバージョンをv1.10.0に更新する必要があります。 サイプレスのハードフォーク・ブロック番号は、Baobabネットワークにおけるハードフォークの安全性を確認した後、次のKlaytnバージョンで指定される。
  - v1.10.0アップグレード後は、デフォルトでNTP時刻同期が必須となります。 ノードがNTPサーバーと同期するのが難しい場合は、ノードの設定に--ntp.disable\`フラグを追加してください。
  - v1.10.0のアップグレード後、ノードオペレータは `rpc.unsafe-debug.disable` フラグでデバッグAPIの一部の機能を制限できるようになりました。 デバッグAPIは信頼できるユーザーに公開されることになっているが、一部のAPIは悪意のあるユーザーに公開されると致命的な問題を引き起こす可能性がある。 このPR](https://github.com/klaytn/klaytn/pull/1746)の "その他のコメント "セクションにある制限の詳細を確認してください。
  - v1.10.0アップグレード後、新しいノードフラグが導入される：snapshot`、`--ntp.disable`、`--ntp.server`、`--rpc.evmtimeout\`である。 詳細は以下をお読みいただきたい。

- dApp開発者向け
  - v1.10.0アップグレード後、ノードオペレータが特別な設定を行うことで、デバッグAPIの一部の機能を制限できるようになりました。 このPR](https://github.com/klaytn/klaytn/pull/1746)の "その他のコメント "セクションにある制限の詳細を確認してください。
  - コレハードフォークの後、EIP-4399の採用により、`opDifficulty`は`opRandom`に置き換えられる。 つまり、オペコード0x44は、ブロックの難易度ではなく、このブロックの前のブロックハッシュを返す。
  - Koreのハードフォーク後、`SLOAD`、`*CALL`、`BALANCE`、`EXT*`、`SELFDESTRUCT`のガスコストは、トランザクショ ンで初めて使用されるときに増加し、EIP-2929の採用により2回目以降は減少する。 また、EIP-2565の採用により、`ModExp`プリコンパイル契約のガスコストが定義される。
  - コレハードフォーク後、EIP-3529の採用により、`SELFDESTRUCT`と`SSTORE`のガス払い戻しが減少する。
  - コレハードフォーク後、EIP-3541の採用により、0xEFバイトで始まる新しいコントラクトのデプロイに失敗する。

- エコシステム参加者向け、
  - v1.10.0アップグレード後、ジニ係数はブロック提案者選択で無効になります。 これは、すべてのCNが偶数の確率でブロックを生成することを意味する。 報奨金はKIP-82に従って別の方法で分配される。 ブロック鋳造量の一部はステーカーに割り当てられ、これは各CNのKLAYステーキング量に比例する。

## プロトコルのアップグレード（コレ・ハードフォーク）の特徴

Koreハードフォークの新機能は、それぞれのハードフォークのブロック番号に従って、BaobabとCypressのネットワークに適用される。

- すべての委員がブロック提案者に選出される確率は平等である(#1655)
- KIP-81：オンチェーン統治投票法の実装 (#1512 #1604 #1614 #1623 #1639 #1640 #1711)
- 契約ベースのオンチェーン・ガバナンス・メカニズムをサポートするためのアップグレード
- ブロックヘッダまたはガバナンス・パラメータ・コントラクトにガバナンス・コンフィギュレーションを格納する。
- KIP-82ジニ係数廃止に伴う新GC報酬体系（#1631 #1642 #1666 #1692 #1709 #1727 #1729 #1734）
  - ブロック提案の報酬を鋳造報酬とステーキング報酬に分ける
  - ブロック生成ごとに、有効なステーカーにステーキング報酬とブロック提案者に報酬を分配する。
- 特定のブロックの燃焼量を含む報酬分配の詳細を返す `klay_getRewards` API を導入。
- EIP-2565：ガス料金の変更 (#1705)
- EIP-2929：州アクセスオプコードのガスコスト増加 (#1705)
- EIP-3529：払い戻しの削減（#1705）
- EIP-3541: 0xEFバイトで始まる新しい契約コードを拒否する (#1681)
- EIP-4399：DIFFICULTY opcode を RANDOM に置き換え (#1680)

### 改善点

- `client.Client`に新しいHTTPヘッダを設定できるようにした (#1632)
- `snapshot`フラグを導入した非同期スナップショットデータ生成機能を追加しました。
- NTPによる時刻同期を強化し、NTP設定フラグ `--ntp.disable` と `--ntp.server` を導入した (#1641 #1651 #1669)。
- gorillaウェブソケットライブラリを導入し、双方向通信を可能にしました。
- Ethereumとの互換性のためにDeriveShaの実装タイプを更新し、ガバナンス項目にしました（#1648 #1689 #1693 #1708 #1716）。
- RPCサーバのメモリ使用量を削減しました。
- `klay_getLogs` APIにblockHashフィルタオプションを追加 (#1653)
- debug_setHead APIで10進数のブロック番号を受け付けました (#1697)
- 状態データベースを検証するための `snapshot` サブコマンドを追加 (#1701)
- `governance_chainConfigAt`APIを導入し、`governance_chainConfig`を改良して、アップグレードされたガバナンス機能をサポートした (#1704 #1724)
- 異常なAPIからノードを保護するために、デバッグAPIの比較的脆弱な機能を制限できる`rpc.unsafe-debug.disable`フラグを導入した(#GHSA-4vx6-m7jv-g2ch #1722 1746)。
- `klay` 名前空間と `governance` 名前空間の `getStakingInfo`、`nodeAddress`、`chainConfig`、`chainConfigAt`、`govParamsAt` API をサポートした。 (#1731)
- ノードオペレータがノードのリソースを管理するために、EVM実行タイムアウトフラグ`--rpc.evmtimeout`を導入しました。

### 修正

- ERC721転送中のServiceChainブリッジオペレータの意図しないガス欠を緩和した (#1445)
- 非WeightedRandom提案者選択時のnilアクセス問題を修正しました(#1600)。
- バックアップの追加ブロックを経由したプロセスの強制終了により、まれにデータベースが破損する問題を修正 (#1630)
- 処理後にストレージスナップショットのデータをデータベースにフラッシュしました。
- istanbulコンセンサスエンジンでCommittedSealsを常に検証するように修正しました。
- `debug.traceBlock`のAPIコールが原因で`gov.changeSet`が破損する問題を解決しました (#1706)
- `klay_getLogs` APIでブロック範囲フィルタが適用されていなかった問題を修正 (#1715)
- eth_getProof APIで常にEmptyRootHashOriginalを使用するように修正 (#1726)

### その他

- Klaytnのバイナリバージョン情報をPrometheusのメトリックに追加しました。
- chaindatafetcherについて、より読みやすく、より多くの情報を提供するようにしました (#1587 #1611)。
- 統合されたDatadog HTTPトレーサー (#1594 #1730)
- 報酬アカウントの鍵ストアが `reward#` というファイル名で生成されるようにHomiを改良しました。
- MagmaHeader検証用のnilチェックロジックを追加しました。
- golangでTLS接続をサポートするようにDockerfileを修正しました。
- addr is not a program account since returning "のログレベルをデバッグレベルに引き下げました(#1643)。
- P2Pメッセージングプロトコルのサイズ制限を10MBから12MBに引き上げました(#1658)。
- Homiを更新し、ServiceChain genesisにより多くのバランスを割り当てるようにした (#1683)
- homiのyaml設定からgenesis.jsonやキーなどを生成するようにしました。
- マイナーアップデート（#1552 #1575 #1598 #1638 #1639 #1640 #1667 #1668 #1685 #1696 #1714 #1717 #1718 #1720 #1723 #1725 #1735）
