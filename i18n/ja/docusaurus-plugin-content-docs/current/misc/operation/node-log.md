# ノードログ

このページでは、カイア・ノードからの重要なログやよくある質問について詳しく説明します。
カイアのログが変更されたり、新しく追加・削除された場合は、このページも編集してください。

ログタイプの詳細については、[log_modules.go](https://github.com/kaiachain/kaia/blob/dev/log/log_modules.go) を参照してください。

異常事態が発生した場合は、[github](https://github.com/kaiachain/kaia/issues)、[Kaia Forum](https://devforum.kaia.io/)、または[Discord](https://discord.com/KaiaOfficial)を通じてkaiaチームまでご報告ください。

## エラーログ

| ログタイプ                 | ノードタイプ   | ログメッセージ                                                                                                                                                                                                                                                                                                                                                                  | 説明                                                                                                                                                                             | 推奨ガイド                                                                                                                                    |
| :-------------------- | :------- | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :--------------------------------------------------------------------------------------------------------------------------------------- |
| Blockchain            | CN/PN/EN | ########## BAD BLOCK #########Chain config: %v<br/><br/>Number: %vHash: 0x%x%v<br/><br/>Error: %v##############################                                                                                                                                                                          | 不良ブロックは、受信したレシーブと実行結果が一致しない場合に発生する。 ノードが不良ブロックログで停止した場合、2つの原因が考えられる。  <br/>- ケース1。 ノードのコンフィギュレーションが、バイナリー・バージョンのように間違っている。  <br/>- ケース2。 コードに問題がある。 他のノードでも同じ問題が発生する可能性が非常に高い。 | このエラーはクリティカルなので、もし悪いブロックを見かけたら、issueを作成するか、Kaia GitHubリポジトリに報告してください。                                                                    |
| ConsensusIstanbulCore | CN/PN/EN | **タイムアウトチャンネルから空のメッセージを削除する。**                                                                                                                                                                                                                                                                                                                                           | ラウンドチェンジタイマーが切れることを意味する。 このエラーは、タイマーが誤って終了した場合に表示される。                                                                                                                          | ダウンローダー起動時にエラーが発生する場合があります。  次のログも出力される：`Block synchronisation started`.                                                 |
| NetworksP2P           | CN/PN/EN | **Protocol istanbul/64 failed** id=04680a827fa1b240 conn=staticdial err="write tcp 10.117.2.105:34396->10.117.2.27:32323: use of closed etwork connection" <br/><br/>**Protocol istanbul/64 failed** err="shutting down" | このログは、もう一方のノードが切断されたときに出力される。 このログには通常、`Disconnected a P2P Peer` というログが続く。                                                                                                     | 切断されたピアが再接続されたかどうかを確認する。 再接続されない場合は、ネットワークの状態またはピア接続をチェックする [admin_peers](../../../references/json-rpc/admin/peers) |
| NodeCN                | CN       | **fail to SendNewBlockHashes** err="write tcp 10.117.2.124:24108->10.117.2.108:32323: use of closed network connection"  <br/><br/>**fail to SendNewBlockHashes** err="shutting down"                                    | プロトコル istanbul/64 に失敗しました。                                                                                                                                                     | プロトコル istanbul/64 に失敗しました。                                                                                                               |
| NodeCN                | CN       | **fail to SendNewBlock** peer=d35220eccdb0de7b err="shutting down"                                                                                                                                                                                                                                                                                                       | プロトコル istanbul/64 に失敗しました。                                                                                                                                                     | プロトコル istanbul/64 に失敗しました。                                                                                                               |
| NetworksRPC           | EN（ほとんど） | **FastWebsocketHandler fail to upgrade message** error="websocket: version != 13"                                                                                                                                                                                                                                                                        | WebSocket接続のバージョン問題                                                                                                                                                            | リクエストのヘッダーには、値を13に設定した `Sec-Websocket-Version`フィールドが含まれていなければならない。 kaia rpcクライアントを使用していない可能性があります。                                       |

## 警告ログ

| ログタイプ                 | ノードタイプ   | ログメッセージ                                                                                                                                                                                                                                                                                                                                                          | 説明                                                                                                                     | 推奨ガイド                                                                                                                                                                       |
| :-------------------- | :------- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :--------------------------------------------------------------------------------------------------------------------- | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Blockchain            | CN/PN/EN | **Upgrade database version** from=N/A to=3                                                                                                                                                                                                                                                                                                                       | ノードの起動時に記録される。                                                                                                         | あなたが対処する必要はない。                                                                                                                                                              |
| ConsensusIstanbulCore | CN       | **[RC]** round=                                                                                                                                                                                                                                                                                              | ラウンド変更ログは[RC]タグで開始されます。                                            | ラウンドが1ラウンドまたは2ラウンドで終了せず、上昇し続ける場合は、ネットワークの状態またはピア接続を最初に分析すべきである。  ピア接続チェック api: [admin_peers](../../../references/json-rpc/admin/peers) |
| ConsensusIstanbulCore | CN       | **unexpected request**  address= state="Accept request" seq=312 err="old message" number=311 hash=d960ea…6df6de                                                                                                                                                                                                                                                  | 提案者がブロックを採掘するが、予想外の結果に。 ほとんどの場合、新しいブロックというには古すぎる。                                                                      | あなたが対処する必要はない。                                                                                                                                                              |
| ノード                   | CN/PN/EN | **Failed doConnTypeHandshake** addr=10.117.2.252:28516 conn=inbound conntype=-1 err="read tcp 10.117.2.78:32324->10.117.2.252:28516: i/o timeout | ダイヤルによって、2つのP2Pピアは接続をセットアップする。 このログは、セットアップに失敗した場合に出力される。                                                              | 切断されたピアが再接続されたかどうかを確認する。 そうでない場合は、ネットワーク・ステータスまたはピア接続をチェックするピア接続チェック・アピ: [admin_peers](../../../references/json-rpc/admin/peers)       |
| NodeCN                | PN/EN    | **Failed to filter bodies** peer=c02e4b4d471c56b9 lenTxs=1                                                                                                                                                                                                                                                                                                       | ノードがフェッチ時に、ボディの不要なブロックヘッダを受信した。  - lenTxs：要求されないTx数                                                                    | あなたが対処する必要はない。                                                                                                                                                              |
| Work                  | CN       | **Transaction aborted due to time limit** hash=                                                                                                                                                                                                                                                                                                                  | マイニング時のブロック実行時間は250msを超えてはならないので、この時間制限のために最後のトランザクションが中止される可能性がある。                                                    | トランザクションがブロックに入ることを確認する。                                                                                                                                                    |
| Work                  | CN       | **Transaction failed, account skipped** hash=b1b26c...6b220a err="insufficient balance for transfer"<br/><br/>Error(before v1.6.2)<br/>Warn(after v1.6.2)                                                  | 採掘中にfrom口座の残高不足により取引が実行できない場合(理論的には、取引が作成されtxpoolに入った時点では残高が十分であったが、実際に実行された時点では残高が十分でなかった場合に発生する)。 | `from`勘定が本当に残高不足かどうかをチェックする。                                                                                                                                                |

## 情報ログ

`Info`ログには、ノードの状態をより詳しく知るための追加情報が含まれているので、`Info`レベルのログを処理する必要はありません。

| ログタイプ       | ノードタイプ   | ログメッセージ                                                                                                                                                                                                                                                                           | 説明                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| :---------- | :------- | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Blockchain  | CN/PN/EN | **Regenerated local transaction journal** transactions=0 accounts=0                                                                                                                                                                                                               | ノードがシャットダウンされると、ローカルTXはファイルにジャーナルされます（デフォルトのファイル名はtransactions.rlp）。 ジャーナルされたファイルを使用してノードを再起動すると、そのファイルに基づいてローカル・トランザクションを再生成できます。  - transactions: 再生成されたローカルトランザクションの番号。  - accounts：再生成されたアカウントの数(==from)                                                                                                                                                                                                                        |
| Blockchain  | CN/PN/EN | **Inserted a new block** number=14 hash=13cbfc…f007fc txs=0 gas=0 elapsed=793.458µs  processTxs=167ns finalize=157.708µs validateState=7.542µs totalWrite=443.417µs trieWrite=256.667µs           | そのノードがそのブロックの提案者でなく、コンセンサスが成功した場合、そのノードはそのブロックを実行(==validates)したことになります。 つまり、ブロックが挿入される。  - gas：TX実行中に消費されたガスの合計。  このフィールドは、ネットワークをテストしてブロックごとの使用ガスを見つけるときによく使われる。                                                                                                                                                                                                                                                                                                  |
| NetworksP2P | CN/PN/EN | **[Dial] Add dial candidate from static nodes**  id=62a08a4b9f091c4b NodeType=0 ip=10.117.2.8 mainPort=32323 port=[32323] | 新しいP2Pピアが接続され、それは静的ノードである。 static-nodes.jsonまたはaddpeer apiを使用して手動で追加されたノードは、静的ノードと呼ばれる。 マルチチャンネルの場合は、2つのポートを使用する。 ex. [32323, 32324].  - id: dstピアID - NodeType: dstノードタイプ(cn,pn,en,bn) - ip: dst ip - mainPort: dst TCPリスニングポート番号 - port: メインポートとサブポートの両方を含むdst TCPリスニングポート番号。 |
| NetworksP2P | CN/PN/EN | **Added a multichannel P2P Peer** id=28a6760472a078fb conn=staticdial peerID=28a6760472a078fb                                                                                                                                                                                     | 新しいピアがマルチチャンネルピアとして接続される。  - id/peerID: 私のノードのピアID - conn: 接続のタイプ - inbound: 誰かが私に接続 - staticdial: static-nodes.jsonやaddPeerなどの静的接続 - trusteddial: trust-nodes.jsonなどの信頼された接続。 最大接続数を超えても、常に再接続して確立することができる。                                                                                                                                                           |
| NetworksP2P | CN/PN/EN | **Disconnected a multichannel P2P Peer** id=28a6760472a078fb conn=inbound    peerID=28a6760472a078fb peerName=Kaia/v1.7.3+acae89350c/darwin-arm64/go1.18.1 err=EOF                                                | マルチチャンネル・ピアが切断された。  - peerName：私のノード情報が表示されます - err：接続が切断された理由                                                                                                                                                                                                                                                                                                                                                                                                                         |
| ネットワークP2P   | CN/PN/EN | **ProtocolManager.processConsensusMsg closed** id=28a6760472a078fb conn=inbound    PeerName=Kaia/v1.7.3+acae89350c/darwin-arm64/go1.18.1                                                          | P2Pノードが切断されると、P2Pノード間のコンセンサス・メッセージ・チャネルも閉じられる。                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| ストレージステートDB | CN/PN/EN | **Persisted trie from memory database** blockNum=23460 updated nodes=4 updated nodes size=499.00B time=539.959µs  gcnodes=68  gcsize=10.55kB gctime=226.499µs  livenodes=245 livesize=37.80kB     | このログは、trie dbがコミットされたことを知らせるために出力される。 ここで、コミットとは、データベースの変更を実際のデータベースに流すことを意味する。  コミットは定期的に行われる。  - ケース1。 ノードがフルノードの場合、トライコミットは128ブロックごとに行われる。  - ケース2。 ノードがアーカイブノードの場合、トライコミットはブロックごとに行われる。  次の状況でもコミットする。  - ノードのシャットダウン時にコミットが行われる。  - メモリサイズが上限を超えるとコミットが行われる。  ヒント  - gcはガベージコレクションの略。 ここで、ガベージコレクションとは、トライノードの変更に伴うdbの書き込みをフラッシュすることを意味する。  - フルノードは、128サイクルごとの情報と最新の128ブロックの情報を保存する。  - アーカイブ・ノードは各ブロックの情報を保存する。                                                                 |
| 仕事          | CN       | **Commit new mining work** number=14 hash=438ef7…68ca7f txs=0 elapsed=605.375µs commitTime=184.708µs finalizeTime=414.375µs                                                                                                       | CN 毎にラウンドチェンジに備えてブロックマイニングを行う - number: ブロック番号 - hash: ブロックハッシュ（最終版ではない） - txs: ブロック内のトランザクション数 - elapsed: ブロックマイニングの総時間（commitTime + finalizeTime） - commitTime: ブロック内のトランザクション実行時間 - finalizeTime: ブロックのファイナライズ時間                                                                                                                                                                    |
| 仕事          | CN       | **Successfully sealed new block** number=14 hash=13cbfc…f007fc                                                                                                                                                                                                                    | [提案者のみ】新しいブロックの封印に成功した。 シーリングには次のステップがある。  - ブロックのコンセンサスプロセス。  - ブロックのタイムスタンプとシグネチャを更新する。                                                                                                                                                                                                                                                                                                                                                                    |
| 仕事          | CN       | **Successfully wrote mined block** num=14 hash=13cbfc…f007fc txs=0 elapsed=617.709µs                                                                                                                                                                              | [提案者のみ] ノードが提案者であり、コンセンサスに成功した場合、提案者はブロックの実行結果をdbに格納する必要がある。 このログは、保存が成功したことを意味する。                                                                                                                                                                                                                                                                                                                                                 |
| 仕事          | CN       | **Mining too far in the future** wait=1s                                                                                                                                                                                                                                          | 1秒間のブロック生成時間を維持するため、ノードは「1秒-直前のブロック生成・伝播・実行時間」の間スリープする。  - wait: ノードがスリープする時間                                                                                                                                                                                                                                                                                                                                                                                          |
| VM          | CN/PN/EN | **Returning since the addr is not a program account** addr=                                                                                                                                                                                                                       | 誰かが存在しない契約に電話をかけようとした。  ヒント カイアでは、プログラム・アカウントは契約アカウントに相当する。                                                                                                                                                                                                                                                                                                                                                                                                                            |
